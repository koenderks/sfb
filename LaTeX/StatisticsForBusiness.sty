% Define packages
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage[margin=2.2cm]{geometry}
\usepackage{helvet}
\usepackage{courier}
\usepackage{titlesec}
\usepackage{tocloft}
\usepackage{menukeys}
\usepackage{lmodern}
\usepackage[most]{tcolorbox}
\usepackage{bookmark}
\usepackage{inconsolata}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{enumitem}
\usepackage{nicefrac}
\usepackage{hyperref}
\usepackage{eurosym}
\usepackage{etoc}
\usepackage{tabularx}
\usepackage{pagecolor}

% Arial letter type
\renewcommand{\familydefault}{\sfdefault}

\newcommand{\RomanNumeralCaps}[1]
    {\MakeUppercase{\romannumeral #1}}

% Define links
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=blue,
    pdfauthor={Koen Derks, Maurice Hoenderdos, Jacques de Swart and Ruud Wetzels},
    pdftitle={Statistics for Business with Applications in R and RStudio},
    pdfsubject={Data Science for Auditor},
    pdfkeywords={key, word},
    pdfproducer={MiKTeX pdfTeX-1.40.13},
    pdfcreator={PdfLaTeX},
    bookmarksnumbered=true,
    bookmarksopen=true,
    bookmarksopenlevel=0,
    pdfstartview=Fit,
    unicode=true,
    pdfpagemode=UseOutlines
}
\urlstyle{same}

% Define colors 
\definecolor{learningobjectives}{RGB}{255, 231, 120}
\definecolor{dataset}{RGB}{24, 134, 45}
\definecolor{rcode}{RGB}{25, 86, 204}
\definecolor{codeblock}{RGB}{208, 231, 255}
\definecolor{concept}{RGB}{198, 0, 0}
\definecolor{answercode}{RGB}{241, 241, 241}
\definecolor{frontpage}{RGB}{0, 0, 0}

% Define header and footer
\pagestyle{fancy}
\fancypagestyle{plain}{%
    \fancyhf[lh]{{\fontsize{12}{14}\selectfont\textit{Statistics for Business}}}%
    %\fancyhf[rh]{{\fontsize{12}{14}\selectfont\textit{\nouppercase{\leftmark}}}}%
    \renewcommand{\headrulewidth}{1pt}%
    \fancyhf[lef,rof]{\thepage}%
    \fancyhf[cf]{}
}
\pagestyle{plain}
\setlength\parindent{0pt}

\fancypagestyle{emptyhead}{                 % Define a new pagestyle
    \fancyhf{}                              % Clear header/footer
    \fancyhf[lh]{{\fontsize{12}{14}\selectfont\textit{Statistics for Business}}}%
    \renewcommand{\headrulewidth}{1pt}%
    \fancyfoot[lef,rof]{\thepage}                 % Set pagenumber in footer
}

% Define table of contents
\setcounter{secnumdepth}{0}

% Define title of table of contents
\renewcommand\cfttoctitlefont{\normalsize\itseries}

% Define fonts in table of contents
\renewcommand\cftchapfont{\normalsize\bfseries}
\renewcommand\cftsecfont{\normalsize\itseries}

% Define fonts of page numbers in table of contents
\renewcommand\cftchappagefont{\normalsize\bfseries}
\renewcommand\cftsecpagefont{\normalsize}

% Set format of 'content' and 'page' in table of contents
\renewcommand\cftaftertoctitle{\hfill\llap{\textit{Page}}}
\renewcommand\contentsname{\vspace{-2cm}\fontsize{16}{18}\selectfont\textit{Content}\vspace{-1cm}}
  
\renewcommand\cftchapafterpnum{\vskip-2pt}
\renewcommand\cftsecafterpnum{\vskip-1pt}
  
% Format the chapter titles
\titleformat{\chapter}[display]{\normalfont}{}{0pt}{\Huge}

% Define chapter front page
\newcommand{\Chapter}[4]{
    \pagestyle{emptyhead}
    \chapter*{
        \fontfamily{\sfdefault}\selectfont
        \color{frontpage} 
        \fontsize{80}{100}\selectfont
        #1\\\medskip\smaller\color{black} #2}
    \addcontentsline{toc}{chapter}{#3}
    \colorbox{frontpage}{
      \begin{minipage}[t]{\textwidth}
      \hfill
        \vspace*{.05cm}
      \end{minipage}
   }\\
   \\
   \\
    #4
   \vspace*{1cm}
   \localtableofcontents
   \clearpage % Page break
   \pagestyle{plain}
}

% Define chapter title in text
\newcommand{\chaptertitle}[1]
{
{\fontsize{16}{18}\selectfont\textit{#1}}
\vspace*{0.75cm}
}
  
% Define assignment title
\titleformat{\section}[hang]
  {\bfseries\textit}{}{}{}
\titlespacing{\section}
  {0cm}{0cm}{0.75cm}
  
% Define subsection titles
\titleformat{\subsection}[hang]
  {\textit}{}{}{}
\titlespacing{\subsection}
  {0cm}{0cm}{0.75cm}

% Define statistical concept
\newcommand{\concept}[1]
{
{\color{concept} \fontfamily{pcr}\selectfont\textbf{#1}}
}

% Define R code
\newcommand{\rcode}[1]
{
{\color{rcode} \fontfamily{zi4}\selectfont\textbf{#1}}
}

% Define R comment
\newcommand{\rcomment}[1]
{
{\color{dataset}\fontfamily{zi4}\selectfont\textbf{\# #1}}
}

% Define data set
\newcommand{\dataset}[1]
{
{\color{dataset} \fontfamily{pcr}\selectfont\textbf{#1}}
}

% Define empty learning objectives box
\newcommand{\emptylearningobjectives}{
    \noindent\makebox[\textwidth][l]{%
      \colorbox{learningobjectives}{%
      \begin{minipage}{\textwidth}
        \vspace*{0.2cm}
        \textbf{\textit{Learning objectives of this chapter:}}
        \vspace*{0.2cm}
        \end{minipage}
}}\vspace{0.75cm}}

% Define R code answer box
\newcommand{\rcodeanswertiny}
{
    \begin{tcolorbox}[colback=black!10!white,colframe=rcode,title=\hspace*{-10pt}\texttt{R} code \thechapter.\thesection\thequestion:]
      \vspace*{.5cm}
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\rcodeanswersmall}
{
    \begin{tcolorbox}[colback=black!10!white,colframe=rcode,title=\hspace*{-10pt}\texttt{R} code \thechapter.\thesection\thequestion:]
      \vspace*{1.5cm}
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\rcodeanswermedium}
{
    \begin{tcolorbox}[colback=black!10!white,colframe=rcode,title=\hspace*{-10pt}\texttt{R} code \thechapter.\thesection\thequestion:]
      \vspace*{2cm}
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\rcodeanswerlarge}
{
    \begin{tcolorbox}[colback=black!10!white,colframe=rcode,title=\hspace*{-10pt}\texttt{R} code \thechapter.\thesection\thequestion:]
      \vspace*{4cm}
    \end{tcolorbox}
    \vspace*{0.5cm}
}
      
% Define full learning objectives box
\newcommand{\learningobjectives}[1]{
    \noindent\makebox[\textwidth][l]{%
      \colorbox{learningobjectives}{%
      \begin{minipage}{\textwidth}
        \vspace*{0.2cm}
        \textbf{\textit{Learning objectives of this chapter:}}
        \begin{itemize}
            #1
        \end{itemize}
        \vspace*{0.02cm}
        \end{minipage}}}
        \vspace{0.75cm}
}

% Define answer boxes
\newcommand{\emptyanswerbox}[1]
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{.5cm}
    #1
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\onelineanswerbox}
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{0.5cm}
    \answerskip
    \rule{\textwidth}{0.4pt}
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\twolineanswerbox}
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{0.5cm}
    \answerskip
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\threelineanswerbox}
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{0.5cm}
    \answerskip
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\fourlineanswerbox}
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{0.5cm}
    \answerskip
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

\newcommand{\sixlineanswerbox}
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{0.5cm}
    \answerskip
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \answerbreak
    \rule{\textwidth}{0.4pt}
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

% Define answer lines
\newcommand{\tinyanswerline}{
    \rule{1cm}{0.4pt} 
}

\newcommand{\shortanswerline}{
    \rule{3cm}{0.4pt} 
}

\newcommand{\mediumanswerline}{
    \rule{6cm}{0.4pt} 
}

\newcommand{\longanswerline}{
    \rule{9cm}{0.4pt} 
}

\newcommand{\answerbreakline}{
    \hline
    \vspace*{.5cm}
}
      
% Define R code block
\newcommand{\codeblock}[1]
{
    \makebox[\textwidth][l]{%
      \colorbox{codeblock}{%
      \begin{minipage}{\textwidth}
        \vspace*{0.2cm}
       {\color{rcode} \fontfamily{zi4}\selectfont \textbf{#1}} 
        \vspace*{0.2cm}
        \end{minipage}
}}\vspace*{0.5cm}}

\newcommand{\answercode}[1]
{
    \makebox[\textwidth][l]{%
      \colorbox{answercode}{%
      \begin{minipage}{\textwidth}
        \vspace*{0.2cm}
       {\color{rcode} \fontfamily{zi4}\selectfont \textbf{#1}} 
        \vspace*{0.2cm}
        \end{minipage}
}}\vspace*{0.5cm}}

% Define itemize space
\let\olditemize\itemize
\renewcommand\itemize{\olditemize\addtolength{\itemsep}{-.2cm}}

\newcommand{\answerskip}{
    \vspace*{.4cm} \\
}

\newcommand{\answerbreak}{
    \vspace*{.1cm} \\
}

% Define question
\renewcommand{\thesection}{\arabic{section}}
\newcounter{question}[section]
\renewcommand{\thequestion}{\alph{question}}
\newcommand{\question}[1]
{
\begin{minipage}[t]{0.08\textwidth}
\stepcounter{question} \thechapter.\thesection \hspace*{3pt} \thequestion) \hfill
\end{minipage}%
\begin{minipage}[t]{0.92\textwidth}
#1
\end{minipage}%
\vspace*{0.5cm}
}

% Define answer
\newcounter{answer}[section]
\renewcommand{\theanswer}{\alph{answer}}
\newcommand{\answer}[1]
{
\begin{minipage}[t]{0.08\textwidth}
\stepcounter{answer} \thechapter.\thesection \hspace*{3pt} \theanswer) \hfill
\end{minipage}%
\begin{minipage}[t]{0.92\textwidth}
\fontfamily{pcr}\selectfont 
#1
\normalfont
\end{minipage}%
\vspace*{0.5cm}
}

% Define beginner R exercise
\newcounter{beginnerexercise}
\setcounter{beginnerexercise}{0}
\newcommand{\beginnerexercise}[1]
{
\begin{minipage}[t]{0.08\textwidth}
\stepcounter{beginnerexercise} B \hspace*{3pt} \thebeginnerexercise) \hfill
\end{minipage}%
\begin{minipage}[t]{0.92\textwidth}
#1
\end{minipage}%
\vspace*{0.5cm}
}

% Define beginner R exercise answer
\newcounter{beginnerexerciseanswer}[subsection]
\newcommand{\beginnerexerciseanswer}[1]
{
\begin{minipage}[t]{0.08\textwidth}
\stepcounter{beginnerexerciseanswer} B \hspace*{3pt} \thebeginnerexerciseanswer) \hfill
\end{minipage}%
\begin{minipage}[t]{0.92\textwidth}
\fontfamily{pcr}\selectfont 
#1
\normalfont
\end{minipage}%
\vspace*{0.5cm}
}

% Define advanced R exercise
\newcounter{advancedexercise}
\setcounter{advancedexercise}{0}
\newcommand{\advancedexercise}[1]
{
\begin{minipage}[t]{0.08\textwidth}
\stepcounter{advancedexercise} A \hspace*{3pt} \theadvancedexercise) \hfill
\end{minipage}%
\begin{minipage}[t]{0.92\textwidth}
#1
\end{minipage}%
\vspace*{0.5cm}
}

% Define hint
\newcounter{hint}[chapter]
\newcommand{\hint}[1]
{
\begin{minipage}{0.08\textwidth}
\begin{center}
    \includegraphics[width=.8\textwidth]{Files/Images/lightbulb.pdf}
\end{center}
\end{minipage}%
\hfill
\begin{minipage}[t]{0.92\textwidth}
\stepcounter{hint} \textit{Hint \thechapter.\thehint: #1}
\end{minipage}%
\vspace*{0.5cm}
}

% Define R assignment
\newcommand{\rassignment}[1]
{
\begin{minipage}{0.8\textwidth}
\section{Assignment \thechapter.\thesection: #1}
\end{minipage}%
\hfill%
\begin{minipage}{0.1\textwidth}
\includegraphics[width=\linewidth]{Files/Images/displaycode.pdf}
\end{minipage}
\vspace*{.1cm}
}

% Define hand assignment
\newcommand{\handassignment}[1]
{
\begin{minipage}{0.8\textwidth}
\section{Assignment \thechapter.\thesection: #1}
\end{minipage}%
\hfill%
\begin{minipage}{0.1\textwidth}
\includegraphics[width=\linewidth]{Files/Images/pencilhand.pdf}
\end{minipage}
\vspace*{.1cm}
}

% Define hypotheses answer box
\newcommand{\hypothesesbox}[1]
{
    \begin{tcolorbox}[colback=white,coltitle=white,colframe=black, title=\hspace*{-10pt}Answer \thechapter.\thesection\thequestion:]
    \fontfamily{pcr}\selectfont 
    \vspace*{0.5cm}
    $H_0$: \shortanswerline \hspace{5cm} $H_1$: \shortanswerline
    \normalfont
    \end{tcolorbox}
    \vspace*{0.5cm}
}

% Define struts
\newcommand\tstrut{\rule{0pt}{2.6ex}}         % = `top' strut
\newcommand\bstrut{\rule[-0.9ex]{0pt}{0pt}}   % = `bottom' strut